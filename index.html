<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Job Feldbrugge" />
  <title>Gaussian Random Field Theory</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel = "icon" href = "figures/icon.jpg" type = "image/x-icon">
  <div class="topnav">
  <a href="https://www2.perimeterinstitute.ca/personal/jfeldbrugge/">Home</a> <a href="https://jfeldbrugge.github.io/">Projects and Code</a>
  </div>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Gaussian Random Field Theory</h1>
<p class="author">Job Feldbrugge</p>
</header>
<p>Gaussian random fields occur on many branches of physics but are in particular crucial to cosmology. Current theories for the early universe predict a nearly homogeneous universe with tiny energy fluctuations</p>
<p><span class="math display">\[
\delta(\boldsymbol{q}) = \frac{\rho(\boldsymbol{q})}{\bar{\rho}} - 1
\]</span></p>
<p>with the energy density <span class="math inline">\(\rho\)</span> and the mean density <span class="math inline">\(\bar{\rho}\)</span>, observable in the cosmic microwave background radiation field. After the epoch of recombination, these fluctuations gravitationally collapse to form the cosmic structure we observe today in cosmological redshift surveys. The seed for the structure in our universe turns out to be very close to a realization of a Gaussian random field with a nearly scale invariant power spectrum. I will here summarize a number of key techniques and results in Gaussian random field theory.</p>
<h3 id="gaussian-random-fields">Gaussian random fields</h3>
<p>Theories for origin of our universe, describe the density perturbation <span class="math inline">\(\delta:\mathbb{R}^d \to \mathbb{R}\)</span> on the space <span class="math inline">\(\mathbb{R}^d\)</span> in terms of random fields. Instead of predicting a particular distribution of the energy in the early universe, the theories describe its statistical properties. We will here restrict attention to initial density fluctuations considered as a realization of a Gaussian random field.</p>
<h4 id="the-definition">The definition</h4>
<p>First, note that the density perturbation has zero mean <span class="math display">\[
\langle \delta \rangle = \langle \rho(\boldsymbol{q}) \rangle / \bar{\rho} - 1 =0.
\]</span> When <span class="math inline">\(\delta\)</span> is a realization of a stationary Gaussian random field, the density perturbation at a point <span class="math inline">\(\delta(\boldsymbol{q})\)</span> is normally distributed. The spatial correlations are fully charaterized by the two-point correlation function <span class="math display">\[
\xi(\boldsymbol{q}_1,\boldsymbol{q}_2) = \langle \delta(\boldsymbol{q}_1) \delta(\boldsymbol{q}_2) \rangle.
\]</span> As it turns out, a random field with a Gaussian PDF with zero mean, which is fully charaterized by its two-point correlation function <span class="math inline">\(\xi(\boldsymbol{q}_1,\boldsymbol{q}_2)\)</span>, is uniquely described by the Gaussian distribution <span class="math display">\[
p(\delta)   = e^{-\frac{1}{2} \iint \delta(\boldsymbol{q}_1) K(\boldsymbol{q}_1,\boldsymbol{q}_2) \delta(\boldsymbol{q}_2)\mathrm{d}\boldsymbol{q}_1\mathrm{d}\boldsymbol{q}_2},
\]</span> with the kernel <span class="math inline">\(K\)</span> defined as the inverse of the two-point correlation function <span class="math display">\[
\int K(\boldsymbol{q}_1,\boldsymbol{q}) \xi(\boldsymbol{q},\boldsymbol{q}_2) \mathrm{d}\boldsymbol{q} = \delta_D^{(d)}(\boldsymbol{q}_1 - \boldsymbol{q}_2),
\]</span> with <span class="math inline">\(\delta_D^{(d)}\)</span> the <span class="math inline">\(d\)</span>-dimensional Dirac delta function. Given a set of fields <span class="math inline">\(S\)</span>, the probability that <span class="math inline">\(\delta \in S\)</span> is given by the functional integral <span class="math display">\[
P[\delta \in S] = \int_S e^{-\frac{1}{2} \iint \delta(\boldsymbol{q}_1)K(\boldsymbol{q}_1,\boldsymbol{q}_2) \delta(\boldsymbol{q}_2)\mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2} \mathcal{D}\delta
\]</span> with <span class="math inline">\(\mathcal{D}\delta\)</span> the path integral measure. The expectation value of some functional <span class="math inline">\(Q\)</span> of <span class="math inline">\(\delta\)</span> is given by the integral <span class="math display">\[
\langle Q[\delta] \rangle = \int Q[\delta] e^{-\frac{1}{2} \iint \delta(\boldsymbol{q}_1)K(\boldsymbol{q}_1,\boldsymbol{q}_2) \delta(\boldsymbol{q}_2)\mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2} \mathcal{D}\delta.
\]</span></p>
<h4 id="the-random-field-at-a-finite-set-of-points">The random field at a finite set of points</h4>
<p>When we set <span class="math inline">\(S\)</span> restricts the density perturbation at a finite number of points <span class="math inline">\(\boldsymbol{q}_i\)</span> for <span class="math inline">\(i=1,2,\dots,n\)</span>, we can write the distribution as a multi-dimensional Gaussian distribution <span class="math display">\[
p(\delta(\boldsymbol{q}_1), \dots,\delta(\boldsymbol{q}_n)) = \frac{\exp\left[-\frac{1}{2} \sum_{i,j}^n \delta(\boldsymbol{q}_i) (M^{-1})_{ij}\delta(\boldsymbol{q}_j)\right]}{
\sqrt{(2\pi)^n \det M}}
\]</span> with the covariance matrix <span class="math display">\[
M_{ij} = \xi(\boldsymbol{q}_i, \boldsymbol{q}_j).
\]</span> Linear statistics of the random field density perturbation <span class="math inline">\(Y=(Y_1,\dots,Y_n)\)</span> follow an analogous disbribution <span class="math display">\[
p(Y) = \frac{\exp\left[-\frac{1}{2} (Y-\bar{Y})^T M_Y^{-1}(Y-\bar{Y}) \right]}
{
\sqrt{(2\pi)^n \det M_Y}}
\]</span> with the mean <span class="math inline">\(\bar{Y}=\langle Y \rangle\)</span> and the covariance matrix <span class="math inline">\(M_Y=\langle Y^T Y \rangle\)</span>.</p>
<h4 id="the-cosmological-principle">The cosmological principle</h4>
<p>It follows from the cosmological principle that the initial conditions of our universe are statistically <em>homogeneous</em> (all points are statistically equivalent) and statistically <em>isotripic</em> (all directions are statistically equivalent). By the homogeneity, the two-point correlation function to only depend on the distance between the points, <span class="math display">\[
\xi(\boldsymbol{q}_1,\boldsymbol{q}_2) = \xi(\boldsymbol{q}_1-\boldsymbol{q}_2).
\]</span> By the isotropy, the two-point correlation function is in addition only sensitive to the norm of the distrance, <span class="math display">\[
\xi(\boldsymbol{q}_1,\boldsymbol{q}_2) = \xi(\|\boldsymbol{q}_1-\boldsymbol{q}_2\|).
\]</span> In these notes, I will always assume statistical homogeneity and isotropy.</p>
<h4 id="gaussian-random-fields-in-fourier-space">Gaussian random fields in Fourier space</h4>
<p>Gaussian random fields are conveniently described in terms of Fourier space. Given the Fourier transform <span class="math display">\[
\hat{\delta}(\boldsymbol{k}) = \int \delta(\boldsymbol{q}) e^{i \boldsymbol{k}\cdot \boldsymbol{q}} \mathrm{d}\boldsymbol{q},
\]</span> and the inverse transformation <span class="math display">\[
\delta(\boldsymbol{q}) = \int \hat{\delta}(\boldsymbol{k}) e^{-i \boldsymbol{k}\cdot \boldsymbol{q}} \frac{\mathrm{d}\boldsymbol{k}}{(2\pi)^d},
\]</span> the two-point correlation function of the Fourier modes is diagonal <span class="math display">\[\begin{align}
\langle \hat{\delta}(\boldsymbol{k}_1) \hat{\delta}^*(\boldsymbol{k}_2)\rangle 
&amp;= \iint e^{i(\boldsymbol{k}_1 \cdot \boldsymbol{q}_1 - \boldsymbol{k}_2 \cdot \boldsymbol{q}_2)} \langle \delta(\boldsymbol{q}_1) \delta(\boldsymbol{q}_2)\rangle \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2 \\
&amp;= \iint e^{i(\boldsymbol{k}_1 \cdot \boldsymbol{q}_1 - \boldsymbol{k}_2 \cdot \boldsymbol{q}_2)} \xi(\|\boldsymbol{q}_1-\boldsymbol{q}_2\|) \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2 \\
&amp;= \iint e^{i(\boldsymbol{k}_1 \cdot (\boldsymbol{q}_1-\boldsymbol{q}_2) +(\boldsymbol{k}_1- \boldsymbol{k}_2) \cdot \boldsymbol{q}_2)} \xi(\|\boldsymbol{q}_1-\boldsymbol{q}_2\|) \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2 \\
&amp;= \int e^{i(\boldsymbol{k}_1- \boldsymbol{k}_2) \cdot \boldsymbol{q}} \mathrm{d}\boldsymbol{q} \int e^{i \boldsymbol{k}_1 \cdot \boldsymbol{r} } \xi(\|\boldsymbol{r}\|) \mathrm{d}\boldsymbol{r}  \\
&amp;=(2\pi)^d \delta_D^{(d)}(\boldsymbol{k}_1-\boldsymbol{k}_2) \int e^{i \boldsymbol{k}_1 \cdot \boldsymbol{r} } \xi(\|\boldsymbol{r}\|) \mathrm{d}\boldsymbol{r}  \\
&amp;=(2\pi)^d \delta_D^{(d)}(\boldsymbol{k}_1-\boldsymbol{k}_2) P(\|\boldsymbol{k}_1\|),
\end{align}\]</span> with the change of coordinates <span class="math inline">\(\boldsymbol{r} = \boldsymbol{q}_1-\boldsymbol{q}_2\)</span> and <span class="math inline">\(\boldsymbol{q}=\boldsymbol{q}_2\)</span> and where the <em>power spectrum</em> <span class="math inline">\(P(k)\)</span> describes the amplitude corresponding to Fourier modes. Note that we use identity</p>
<p><span class="math display">\[\int e^{i \boldsymbol{k}\cdot \boldsymbol{q}}\mathrm{d}\boldsymbol{q} = (2\pi)^d \delta_D^{(d)}(\boldsymbol{k}).\]</span></p>
<p>The power spectrum is the Fourier transform of the correlation function. For two-dimensional random fields <span class="math display">\[\begin{align}
P(k) &amp;= \int e^{i \boldsymbol{k} \cdot \boldsymbol{r} } \xi(\|\boldsymbol{r}\|) \mathrm{d}\boldsymbol{r}\\
&amp;= \int_0^\infty \left[ \int_0^{2\pi} e^{i k r \cos\theta } \mathrm{d}\theta \right]\xi(r) r \mathrm{d}r\\
&amp;= 2\pi \int_0^\infty r J_0(kr)\xi(r) \mathrm{d}r,
\end{align}\]</span> with <span class="math inline">\(J_0\)</span> the Bessel function of the first kind and <span class="math inline">\(k=\|\boldsymbol{k}\|\)</span>, using the polar coordinate measure <span class="math inline">\(\mathrm{d}\boldsymbol{r} = r \mathrm{d}r \mathrm{d}\theta\)</span>. For three-dimensional random fields <span class="math display">\[\begin{align}
P(k) &amp;= \int e^{i \boldsymbol{k} \cdot \boldsymbol{r} } \xi(\|\boldsymbol{r}\|) \mathrm{d}\boldsymbol{r}\\
&amp;= \int_0^\infty \left[\int_0^{2\pi} e^{i k r \cos \varphi} \mathrm{d}\varphi \int_0^\pi  \sin \theta \mathrm{d}\theta\right] \xi(r) r^2 \mathrm{d}r\\
&amp;= 4 \pi \int_0^\infty  r^2 J_0(kr) \xi(r) \mathrm{d}r,
\end{align}\]</span> using the spherical coordiante measure <span class="math inline">\(\mathrm{d}\boldsymbol{r} = r^2\sin \theta\mathrm{d}r \mathrm{d}\theta \mathrm{d}\varphi\)</span>.</p>
<p>Not only are the two-point correlations of the Fourier modes diagonal, the Fourier modes are independent. Since the Fourier modes fully determine the real-space fields, we obtain the distribution of the Fourier modes <span class="math display">\[\begin{align}
p(\hat{\delta}) &amp;= \exp\left[ -\frac{1}{2} \iint \delta(\boldsymbol{q}_1) K(\boldsymbol{q}_1 -\boldsymbol{q}_2) \delta(\boldsymbol{q}_2) \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2\right]\\
%%%%%
&amp;= \exp\left[ -\frac{1}{2} \iint 
\left[\int \hat{\delta}(\boldsymbol{k}_1) e^{-i\boldsymbol{q}_1 \cdot \boldsymbol{k}_1} \frac{\mathrm{d}\boldsymbol{k}_1}{(2\pi)^d} \right]
K(\boldsymbol{q}_1 -\boldsymbol{q}_2)
\left[\int \hat{\delta}^*(\boldsymbol{k}_2) e^{i\boldsymbol{q}_2 \cdot \boldsymbol{k}_2} \frac{\mathrm{d}\boldsymbol{k}_2}{(2\pi)^d} \right]
 \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2\right]\\
 %%%%%
 &amp;= \exp\left[ -\frac{1}{2}
  \iint
  \hat{\delta}(\boldsymbol{k}_1) \left[
\iint 
e^{-i\boldsymbol{q}_1\cdot  \boldsymbol{k}_1+ i\boldsymbol{q}_2 \cdot \boldsymbol{k}_2}
 K(\boldsymbol{q}_1 -\boldsymbol{q}_2)
  \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2\right] 
  \hat{\delta}^*(\boldsymbol{k}_2)   
  \frac{\mathrm{d}\boldsymbol{k}_1}{(2\pi)^d} \frac{\mathrm{d}\boldsymbol{k}_2}{(2\pi)^d}\right]\\
  %%%%%
  &amp;= \exp\left[ -\frac{1}{2}
   \iint
   \hat{\delta}(\boldsymbol{k}_1) \left[
 \iint 
 e^{-i(\boldsymbol{q}_1 - \boldsymbol{q}_2) \cdot \boldsymbol{k}_1+ i\boldsymbol{q}_2 \cdot (\boldsymbol{k}_2-\boldsymbol{k}_1)}
  K(\boldsymbol{q}_1 -\boldsymbol{q}_2)
   \mathrm{d}\boldsymbol{q}_1 \mathrm{d}\boldsymbol{q}_2\right] 
   \hat{\delta}^*(\boldsymbol{k}_2)   
   \frac{\mathrm{d}\boldsymbol{k}_1}{(2\pi)^d} \frac{\mathrm{d}\boldsymbol{k}_2}{(2\pi)^d}\right]\\
   %%%%%
   &amp;= \exp\left[ -\frac{1}{2}
    \iint
    \hat{\delta}(\boldsymbol{k}_1) \left[
    (2\pi)^d \delta_D^{(d)}(\boldsymbol{k}_1 - \boldsymbol{k}_2)
  \int 
  K(\boldsymbol{r})
  e^{i \boldsymbol{r} \cdot   \boldsymbol{k}_1}
    \mathrm{d}\boldsymbol{r}\right] 
    \hat{\delta}^*(\boldsymbol{k}_2)   
    \frac{\mathrm{d}\boldsymbol{k}_1}{(2\pi)^d} \frac{\mathrm{d}\boldsymbol{k}_2}{(2\pi)^d}\right]\\
    %%%%%
    &amp;= \exp\left[ -\frac{1}{2}
     \int
     |\hat{\delta}(\boldsymbol{k})|^2 
    \hat{K}(\boldsymbol{k})
     \frac{\mathrm{d}\boldsymbol{k}}{(2\pi)^d} \right].
\end{align}\]</span></p>
<p>Using the definition of the kernel can be written in terms of Fourier space using the convolution theorem <span class="math display">\[\begin{align}
\delta_D^{(d)}(\boldsymbol{q}_1-\boldsymbol{q}_2) 
&amp;=\int K(\boldsymbol{q}_1 - \boldsymbol{q}) \xi(\boldsymbol{q}-\boldsymbol{q}_2) \mathrm{d}\boldsymbol{q}\\
&amp;=\iint K(\boldsymbol{q}_1 - \boldsymbol{q})  P(k) e^{i \boldsymbol{k} \cdot (\boldsymbol{q}-\boldsymbol{q}_2)} \frac{\mathrm{d}\boldsymbol{k} }{(2\pi)^d}\mathrm{d}\boldsymbol{q}\\
&amp;=\int  \left[\int K(\boldsymbol{q}_1 - \boldsymbol{q})  e^{-i \boldsymbol{k} \cdot (\boldsymbol{q}_1-\boldsymbol{q})} \mathrm{d}\boldsymbol{q} \right]P(k) e^{i \boldsymbol{k} \cdot (\boldsymbol{q}_1-\boldsymbol{q}_2)} \frac{\mathrm{d}\boldsymbol{k} }{(2\pi)^d}\\
&amp;= \int \hat{K}(\boldsymbol{k})P(k) e^{i \boldsymbol{k} \cdot (\boldsymbol{q}_1-\boldsymbol{q}_2)}\frac{\mathrm{d}\boldsymbol{k}}{(2\pi)^d},
\end{align}\]</span> yielding <span class="math inline">\(\hat{K}(\boldsymbol{k}) = 1 /P(k)\)</span> for all <span class="math inline">\(\boldsymbol{k}\)</span>. Substituting the Fourier transform of the kernel into the distribution, we obtain the simple expression <span class="math display">\[\begin{align}
p(\hat{\delta}) = \exp\left[ - \int \frac{|\hat{\delta}(\boldsymbol{k})|^2}{2 P(k)}  \frac{\mathrm{d}\boldsymbol{k}}{(2\pi)^d} \right].
\end{align}\]</span> This demonstrates that the amplitudes of the Fourier modes <span class="math inline">\(|\hat{\delta}|\)</span> are normally distributed with the standard deviation <span class="math inline">\(\sqrt{P(k)}\)</span> and the arguments <span class="math inline">\(\text{arg}(\hat{\delta})\)</span> are uniformly distributed. Furthermore note that the Fourier modes are independent modulo the reality condition <span class="math display">\[\begin{align}
\hat{\delta}^*(-\boldsymbol{k}) 
=\left[ \int \delta(\boldsymbol{q}) e^{-i\boldsymbol{k}\cdot \boldsymbol{q}}\mathrm{d}\boldsymbol{q}\right]^*
= \int \delta(\boldsymbol{q}) e^{i\boldsymbol{k}\cdot \boldsymbol{q}}\mathrm{d}\boldsymbol{q}
= \hat{\delta}(\boldsymbol{k})
\end{align}\]</span> with <span class="math inline">\(\delta(\boldsymbol{q}) = \delta^*(\boldsymbol{q})\)</span>.</p>
<h3 id="generating-realizations">Generating realizations</h3>
<p>In the analysis above, we observe that Gaussian random fields are most easily expressed in terms of Fourier space as the exponent of the distribution is diagonal in <span class="math inline">\(\hat{\delta}\)</span>. Note that the Fourier transform of a real-valued function <span class="math inline">\(\delta:\mathbb{R}^d \to \mathbb{R}\)</span> satisfies the condition <span class="math inline">\(\hat{\delta}(\boldsymbol{k}) = \hat{\delta}^*(-\boldsymbol{k})\)</span>.</p>
<p>Generating a realization of a Gaussian random field on a regular lattice <span class="math inline">\(\{ \boldsymbol{q}_{i_1,\dots,i_d}\}\)</span>, with the values <span class="math inline">\(\delta_{i_1,\dots,i_d} = \delta(\boldsymbol{q}_{i_1,\dots,i_d})\)</span>, can thus be reduced to drawing the normally distributed Fourier modes <span class="math inline">\(\hat{\delta}_{i_1,\dots,i_d}\)</span> with the reality condition <span class="math inline">\(\hat{\delta}^*_{-i_1,\dots,-i_d} = \hat{\delta}_{i_1,\dots,i_d}\)</span>. The realization <span class="math inline">\(\{\delta_{i_1,\dots,i_d}\}\)</span> are can be efficiently evaluated with the inverse fast Fourier transform.</p>
<p>These observations allow for an efficient algorithm for the generation of Gaussian random fields:</p>
<ol type="1">
<li>White noise: Generate the set of identically distributed random numbers <span class="math inline">\(n_{i_1,\dots,i_d} \sim \mathcal{N}(0,1)\)</span>.</li>
<li>Fourier transform the noise: Fast Fourier transform the realization of the white noise <span class="math inline">\(\{\hat{n}_{i_1,\dots,i_d}\} = FFT[\{n_{i_1,\dots,i_d}\}]\)</span>. The Fourier transform consists of complex random numbers with a Gaussian amplitude <span class="math inline">\(\mathcal{N}(0,1)\)</span>, a uniformly distributed argument, satisfying the reality condition <span class="math inline">\(\hat{n}^*_{-i_1,\dots,-i_d} = \hat{n}_{i_1,\dots,i_d}\)</span>.</li>
<li>Scale the Fourier modes: Define the Fourier modes <span class="math inline">\(\hat{\delta}_{i_1,\dots,i_d} = \sqrt{P(\|\boldsymbol{k}_{i_1,\dots,i_d}\|)}\hat{n}_{i_1,\dots,i_d}\)</span>. The modes <span class="math inline">\(\hat{\delta}_{i_1,\dots,i_d}\)</span> are independent complex random numbers of which the amplitudes are normally distributed <span class="math inline">\(|\hat{\delta}_{i_1,\dots,i_d}| \sim \mathcal{N}(0,\sqrt{P(\|\boldsymbol{k}_{i_1,\dots,i_d}\|)})\)</span> satisfying the reality condition <span class="math inline">\(\hat{\delta}^*_{-i_1,\dots,-i_d} = \hat{\delta}_{i_1,\dots,i_d}\)</span>.</li>
<li>Transform to real-space: Use the inverse Fourier transform to generate the Gaussian random field <span class="math inline">\(\{ \delta_{i_1,\dots,i_d}\} = FFT^{-1}(\{ \hat{\delta}_{i_1,\dots,i_d}\})\)</span>.</li>
</ol>
<h3 id="geometric-statistics">Geometric statistics</h3>
<p>In 1936 Stephen Rice, while working at Bell-Labs, developed a framework to calculate the number densities of points in one-dimensional random fields. In the subsequent years, the results were extended to multi-dimensional random fields.</p>
<p><strong>Rice’s formula:</strong> <em>Consider set of points</em> <span class="math display">\[
\Lambda(\lambda_1,\dots,\lambda_d) = \{\boldsymbol{q} \in \mathbb{R}^d| f_i[\delta] (\boldsymbol{q}) = \lambda_i\}
\]</span> <em>with the <span class="math inline">\(d\)</span> smooth conditions <span class="math inline">\(f_i[\delta]:\mathbb{R}^d \to \mathbb{R}\)</span> of the function <span class="math inline">\(\delta : \mathbb{R}^d\to \mathbb{R}\)</span> and <span class="math inline">\(\lambda_i \in \mathbb{R}\)</span>, with <span class="math inline">\(i=1,\dots,d\)</span>. For convenience we drop the the dependence on <span class="math inline">\(\delta\)</span> from the notation, i.e., <span class="math inline">\(f_i=f_i[\delta]\)</span> . When <span class="math inline">\(\delta\)</span> is a homogeneous random field and the set <span class="math inline">\(\Lambda(\lambda_1,\dots,\lambda_d)\)</span> amost always consists of only isolated points, the number density <span class="math inline">\(\mathcal{N}(\lambda_1,\dots,\lambda_d)\)</span> of points in <span class="math inline">\(\Lambda(\lambda_1,\dots,\lambda_d)\)</span> is equal to the expectation value</em> <span class="math display">\[
\mathcal{N}(\lambda_1,\dots,\lambda_d) =\left \langle \left|\det 
\left[\frac{\partial f_j}{\partial q_i}\right]_{i,j=1,\dots,d}\right| \prod_{i=1}^d \delta_D^{(d)}(f_i(\boldsymbol{q})- \lambda_i)\right\rangle.
\]</span></p>
<p><strong>Proof:</strong> <em>Given a continuous and differentiable realization of a the random field, construct the generalized function</em> <span class="math display">\[
n(\boldsymbol{q}) = \sum_{\boldsymbol{r} \in \Lambda(\lambda_1,\dots,\lambda_d)} \delta_{D}^{(d)}(\boldsymbol{q}-\boldsymbol{r}).
\]</span> <em>The number of points in <span class="math inline">\(\Lambda(\lambda_1,\dots,\lambda_d)\)</span> for this realization is given by the integral <span class="math inline">\(\int n(\boldsymbol{q}) \mathrm{d}\boldsymbol{q}\)</span>. Now, since the points in <span class="math inline">\(\Lambda(\lambda_1,\dots,\lambda_d)\)</span> are isolated, every point <span class="math inline">\(\boldsymbol{r} \in \Lambda(\lambda_1,\dots,\lambda_d)\)</span> has a open set <span class="math inline">\(U_\boldsymbol{r}\)</span> containing only this point. We can write the number of points in <span class="math inline">\(\Lambda(\lambda_1,\dots,\lambda_d)\)</span> as</em> <span class="math display">\[\begin{align}
\int n(\boldsymbol{q}) \mathrm{d}\boldsymbol{q} 
&amp;= \int \sum_{\boldsymbol{r} \in \Lambda(\lambda_1,\dots,\lambda_d)} \delta_{D}^{(d)}(\boldsymbol{q}-\boldsymbol{r}) \mathrm{d}\boldsymbol{q}\\
&amp;= \sum_{\boldsymbol{r} \in \Lambda(\lambda_1,\dots,\lambda_d)} \int_{U_\boldsymbol{r}} \delta_{D}^{(d)}(\boldsymbol{q}-\boldsymbol{r}) \mathrm{d}\boldsymbol{q}\\
&amp;= \sum_{\boldsymbol{r} \in \Lambda(\lambda_1,\dots,\lambda_d)} \int_{U_\boldsymbol{r}}  \left| \det [\partial_i f_j(\boldsymbol{q})]_{i,j} \right|
\prod_{i=1}^d\delta_{D}^{(1)}(f_i(\boldsymbol{q})-\lambda_i) \mathrm{d}\boldsymbol{q}
\end{align}\]</span> <em>using the transformation of the Dirac delta function</em> <span class="math display">\[
\int_{U} \delta_D^{(d)}( \boldsymbol{q} - \boldsymbol{f}^{-1}(\boldsymbol{\lambda})) \mathrm{d}\boldsymbol{q} = \int_U \delta_D^{(d)}(f(\boldsymbol{q}) - \boldsymbol{\lambda}) | \det \nabla \boldsymbol{f}|\mathrm{d}\boldsymbol{q},
\]</span> <em>for a smooth vector-valued function <span class="math inline">\(\boldsymbol{f}:\mathbb{R}^d \to \mathbb{R}^d\)</span> and <span class="math inline">\(\boldsymbol{\lambda} \in \mathbb{R}^d\)</span> assuming <span class="math inline">\(f(\boldsymbol{q}) = \boldsymbol{\lambda}\)</span> for only a single point <span class="math inline">\(\boldsymbol{q}\in U\)</span>. As the integrand has only support for the point <span class="math inline">\(\boldsymbol{r}\)</span> we can write the sum of integrals over <span class="math inline">\(U_{\boldsymbol{r}}\)</span> as a single integral over <span class="math inline">\(\mathbb{R}^d\)</span>. Using these identities, we obtain the number density of points in <span class="math inline">\(\Lambda(\lambda_1,\dots,\lambda_d)\)</span> as the expectation value</em> <span class="math display">\[\begin{align}
\mathcal{N}(\lambda_1,\dots,\lambda_d) 
&amp;=\left \langle 
\frac{\int_L n(\boldsymbol{q}) \mathrm{d}\boldsymbol{q}}{\int_L  \mathrm{d}\boldsymbol{q}}
\right\rangle\\
&amp;=
\frac{\int_L \left\langle  \left| \det [\partial_i f_j(\boldsymbol{q})]_{i,j} \right|
\prod_{i=1}^d\delta_{D}^{(1)}(f_i(\boldsymbol{q})-\lambda_i)\right\rangle \mathrm{d}\boldsymbol{q}}{\int_L  \mathrm{d}\boldsymbol{q}}\\
&amp;=\left \langle \left|\det 
\left[\frac{\partial f_j}{\partial q_i}\right]_{i,j=1,\dots,d}\right| \prod_{i=1}^d \delta_D^{(d)}(f_i(\boldsymbol{q})- \lambda_i)\right\rangle
\end{align}\]</span> <em>in a regulating box <span class="math inline">\(L \subset \mathbb{R}^d\)</span> in the limit <span class="math inline">\(L \to \mathbb{R}^d\)</span>, since the expectation value is independent of the position by the statistical homogeneity.</em></p>
<p>To illustrate Rice’s formula, consider a few examples:</p>
<p><strong>Example 1:</strong> <em>The number density of level crossings <span class="math inline">\(\delta = \nu\)</span> in a one-dimensional random field <span class="math inline">\(\delta\)</span> correspond to the condition <span class="math inline">\(f_1[\delta] = \delta\)</span> and <span class="math inline">\(\lambda_1=\nu\)</span>. Using Rice’s formula we obtain</em> <span class="math display">\[\begin{align}
\mathcal{N}(\nu) &amp;= \langle |\delta&#39;(q)| \delta_D^{(1)}(\delta(q)-\nu) \rangle\\
&amp;= \int |\delta&#39;(q)| p(\delta = \nu,\delta&#39;)\ \mathrm{d} \delta&#39;.
\end{align}\]</span> <em>We can select for up- and down-crossings by restricting the integral over <span class="math inline">\(\delta&#39;\)</span> to <span class="math inline">\([0,\infty)\)</span> and <span class="math inline">\((-\infty,0]\)</span>.</em></p>
<p><strong>Example 2:</strong> <em>The number density of critical points in a one-dimensional random field <span class="math inline">\(\delta\)</span> at function value <span class="math inline">\(\nu\in \mathbb{R}\)</span>. At a critical point, the first order derivative vanishes, i.e., consider the conditions <span class="math inline">\(f_1[\delta] = \delta&#39;\)</span> and <span class="math inline">\(\lambda_1=0\)</span>. The number density thus takes the form</em> <span class="math display">\[\begin{align}
\mathcal{N}(\nu) &amp;= \langle \left| \delta&#39;&#39;(q)\right| \delta_D^{(1)}(\delta(q) - \nu)\delta_D^{(1)}(\delta&#39;(q)) \rangle\\
&amp;= \int |\delta&#39;&#39;| p(\delta =\nu, \delta&#39; = 0,\delta&#39;&#39;) \mathrm{d}\delta&#39;&#39;.
\end{align}\]</span> <em>We can refine to the number density of maxima and minima by restricting the integral over <span class="math inline">\(\delta&#39;&#39;\)</span> to the intervals <span class="math inline">\((-\infty,0]\)</span> and <span class="math inline">\([0,\infty)\)</span>.</em></p>
<p><strong>Example 3:</strong> <em>The number density of critical points in a two-dimensional random field <span class="math inline">\(\delta\)</span> at function value <span class="math inline">\(\nu \in \mathbb{R}\)</span>. At the critical point, the first order derivatives vanish, i.e., consider the conditions <span class="math inline">\(f_1[\delta] = \partial_1 \delta, f_2[\delta] = \partial_2 \delta\)</span> and <span class="math inline">\(\lambda_1=\lambda_2 = 0\)</span>. The number density thus takes the form</em> <span class="math display">\[\begin{align}
\mathcal{N}(\nu) &amp;= \left\langle \left| \det \begin{pmatrix} \partial_1^2 \delta &amp; \partial_1 \partial_2 \delta \\ \partial_1 \partial_2 \delta &amp; \partial_2^2 \delta \end{pmatrix} \right| 
\delta_D^{(1)}(\delta - \nu)\delta_D^{(1)}(\partial_1 \delta) \delta_D^{(1)}(\partial_2\delta) \right \rangle\\
&amp;= \iiint |\partial_1^2 \delta\ \partial_2^2 \delta -(\partial_1 \partial_2 \delta)^2| p(\delta = \nu, \nabla \delta = 0, \partial_1^2 \delta, \partial_1 \partial_2 \delta, \partial_2^2 \delta) \
\mathrm{d}(\partial_1^2 \delta)\ \mathrm{d}(\partial_1 \partial_2 \delta)\ \mathrm{d} (\partial_2^2 \delta).
\end{align}\]</span> <em>We can refine to the number density of maxima, minima, and saddle points by restricting the integratin domain to the domains for which the Hessian as either two negative eigenvalues, two positive eigenvalues, or one negative and one positive eigenvalues.</em></p>
<h3 id="distribution-of-eigenvalue-fields">Distribution of eigenvalue fields</h3>
<h3 id="generating-constraint-realizations">Generating constraint realizations</h3>
<h3 id="cosmological-power-spectra">Cosmological power spectra</h3>
<h3 id="non-gaussianities-and-phase-correlations">Non-Gaussianities and phase-correlations</h3>
<h3 id="path-integrals-and-statistical-field-theory">Path integrals and statistical field theory</h3>
</body>
</html>
